<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="© Copyright IBM Corporation 2017" />
<meta name="DC.Rights.Owner" content="© Copyright IBM Corporation 2017" />
<meta name="security" content="public" />
<meta name="Robots" content="index,follow" />
<meta name="DC.Type" content="task" />
<meta name="DC.Title" content="Adding a GatewayScript action" />
<meta name="abstract" content="Add a GatewayScript action to the assembly. The GatewayScript action uses a specified GatewayScript file in a directory on the DataPower Gateway." />
<meta name="Description" content="Add a GatewayScript action to the assembly. The GatewayScript action uses a specified GatewayScript file in a directory on the DataPower Gateway." />
<meta name="DC.Relation" scheme="URI" content="apigw_addingparseaction.html" />
<meta name="DC.Relation" scheme="URI" content="filemanagement_directories.html" />
<meta name="DC.Relation" scheme="URI" content="apigateway_gatewayscript_general.html" />
<meta name="DC.Relation" scheme="URI" content="apigw_configuringassembly.html" />
<meta name="DC.Date" scheme="iso8601" content="2017-05-11" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="apigw_addinggatewayscriptaction" />
<meta name="DC.Language" content="en-us" />
<meta name="IBM.Country" content="ZZ" />
<!-- Licensed Materials - Property of IBM -->
<!-- US Government Users Restricted Rights -->
<!-- Use, duplication or disclosure restricted by -->
<!-- GSA ADP Schedule Contract with IBM Corp. -->
<link rel="stylesheet" type="text/css" href="./ibmdita.css" />
<link rel="Start" href="apigw_configuringassembly.html" />
<title>Adding a GatewayScript action</title>
</head>
<body id="apigw_addinggatewayscriptaction"><div role="main">
<h1 class="title topictitle1">Adding a <span class="ph">GatewayScript</span> action<span class="ph"><img src="./7.6.0.gif" alt="7.6.0" /><img src="./end.gif" alt="" /></span></h1>
<div class="body taskbody"><p class="shortdesc">Add a <span class="ph">GatewayScript</span> action to the assembly. The
<span class="ph">GatewayScript</span> action uses a specified <span class="ph">GatewayScript</span> file in a directory on the <span class="ph">DataPower® Gateway</span>. </p>
<div class="section context"><div class="tasklabel"><h2 class="sectiontitle tasklabel" id="taskd308e36">About this task</h2></div><div class="p">When the <span class="ph">GatewayScript</span> files calls the following APIs, you can add
a parse action to the assembly.<ul class="ul"><li class="li"><samp class="ph codeph">apim.readInput()</samp></li>
<li class="li"><samp class="ph codeph">apim.readInputAsJSON()</samp></li>
<li class="li"><samp class="ph codeph">apim.readInputAsBuffer()</samp></li>
<li class="li"><samp class="ph codeph">apim.readInputAsXML()</samp></li>
</ul>
   You can specify the location of the <span class="ph">GatewayScript</span> file with a
URL or by referencing the <samp class="ph codeph">request.headers.<var class="keyword varname">X-SOURCE-URL</var></samp> API
context variable.<ul class="ul"><li class="li">The URL must start with the <span class="ph filepath">local:</span>, <span class="ph filepath">store:</span>, or
<span class="ph filepath">temporary:</span> directory. For example, the location of the <samp class="ph codeph">test.js</samp>
script file is
<samp class="ph codeph">local:///test.js</samp>.</li>
<li class="li">In the <samp class="ph codeph">request.headers.X-SOURCE-URL</samp> API context variable, the
<var class="keyword varname">X-SOURCE-URL</var> indicates the URL that specifies the directory of the script file.
Reference this variable with the <samp class="ph codeph">$(request.headers.<var class="keyword varname">X-SOURCE-URL</var>)</samp>
format.</li>
</ul>
</div>

<div class="p">The <span class="ph">GatewayScript</span> file can use only the following <span class="ph">GatewayScript</span> object and modules:
<ul class="ul" id="apigw_addinggatewayscriptaction__module_list"><li class="li"><samp class="ph codeph">apim</samp> module</li>
<li class="li"><samp class="ph codeph">context</samp> object</li>
<li class="li"><samp class="ph codeph">fs</samp> module </li>
<li class="li"><samp class="ph codeph">multistep</samp> module </li>
<li class="li"><samp class="ph codeph">service-metadata</samp> module </li>
</ul>
See the reference information about the <span class="ph">GatewayScript</span>
objects and modules for the usage.</div>
</div>
<div class="tasklabel"><h2 class="sectiontitle tasklabel" id="taskd308e130">Procedure</h2></div><ol class="ol steps"><li class="li step"><span class="ph cmd">In the search field, enter <kbd class="ph userinput">assembly</kbd>.</span></li>
<li class="li step"><span class="ph cmd">From the search results, select <span class="ph uicontrol">Assembly GatewayScript</span>.</span></li>
<li class="li step"><span class="ph cmd">Specify the location of the script file.</span></li>
<li class="li step"><span class="ph cmd">Click <span class="ph uicontrol">Add</span> or <span class="ph uicontrol">New</span>.</span></li>
<li class="li step"><span class="ph cmd">Define the basic properties: Name, administrative state, and descriptive summary.</span></li>
<li class="li step"><span class="ph cmd">Specify the name and location of the <span class="ph">GatewayScript</span>
file.</span></li>
</ol>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="apigw_configuringassembly.html" title="An assembly defines the data processing capabilities of an API definition. When an API is matched for an API request, the API execute action in the API processing rule runs the assembly of the API to respond to the request. The information instructs how to create an assembly.">Creating an assembly</a></div>
</div>
<div class="relinfo relconcepts"><strong>Related concepts</strong>:<br />
<div><a class="link" href="apigateway_gatewayscript_general.html" title="The GatewayScript programming in API Gateway follows the programming guidelines of the DataPower Gateway Gateway programming model.">GatewayScript APIs for API management</a></div>
</div>
<div class="relinfo reltasks"><strong>Related tasks</strong>:<br />
<div><a class="link" href="apigw_addingparseaction.html" title="An assembly parse action controls the parsing of an input document which can be an XML or JSON document, or binary data from the API context. When a parse action is configured for an assembly rule, the parse settings that are associated with the parse action override the corresponding parser limits for input documents that are set by the XML manager.">Adding a parse action to the assembly</a></div>
</div>
<div class="relinfo"><strong>Related information</strong>:<br />
<div><a class="link" href="filemanagement_directories.html">File management</a></div>
</div>
</div></div></body>
</html>