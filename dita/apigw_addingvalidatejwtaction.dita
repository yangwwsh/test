<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE task PUBLIC "-//OASIS//DTD DITA Task//EN" "task.dtd">
<task id="apigw_addingvalidatejwtaction" xml:lang="en-us">
<title>Adding a validate JWT action</title>
<shortdesc>A validate JWT action defines the cryptographic material and methods to validate a JSON
Web Token (JWT) in an API call to secure access to your APIs.</shortdesc>
<taskbody>
<context>
<p>The validate JWT action extracts the JWT in the API call, verifies and decrypts the JWT,
validates the claims, and stores all the claims into a context variable for subsequent use when the
JWT validation succeeds. In a validate JWT action, you define the following settings.<ul>
<li>The JWT to be validated.<note>The format of the authorization header must be
<codeph>Authorization: Bearer <varname>jwt-token</varname></codeph>, where
<varname>jwt-token</varname> indicates the encoded JWT.</note></li>
<li>Where to put all the claims that the JWT contains when the JWT validation succeeds.</li>
<li>Optionally, values to use to validate the issuer claim or audience claim in the JWT.<ul>
<li>When no value is specified, the action validates only the expiration
<q><codeph>exp</codeph></q>claim and the not before <q><codeph>nbf</codeph></q> claim in the
JWT.</li>
<li>When any value is specified, the action also validates the specified claim. If any specified
claim fails, the JWT validation fails.</li>
</ul>
</li>
<li>The cryptographic material to decrypt or verify a JWT. The following guidelines apply.<ul>
<li>You can use a cryptographic object or a JWK to decrypt or verify the JWT. When both a
cryptographic object and a JWK are specified, the cryptographic object is used.</li>
<li>If the original message is signed with a shared secret key, the cryptographic object that is
specified must also be a shared secret key.</li>
<li>If the original message is signed with a private key, the cryptographic object that is specified
must be a crypto certificate (public certificate).</li>
<li>If a JWK header parameter is included in the header of the JWT, the parameter must match the
cryptographic object or JWK that is specified in the action. Otherwise, the JWT validation
fails.</li>
</ul>
</li>
</ul></p>
<p>When the JWT validation succeeds, all the claims that the JWT contains are written to the
specified context variable. When an error occurs, the action throws an error.</p>
</context>
<steps>
<step conref="apigw_conref.dita#commonsteps/search_assembly">
<cmd/>
</step>
<step>
<cmd>From the search results, select <uicontrol>Assembly Validate JWT Action</uicontrol>.</cmd>
</step>
<step conref="apigw_conref.dita#commonsteps/config_add">
<cmd/>
</step>
<step conref="apigw_conref.dita#commonsteps/config_basicproperties">
<cmd/>
</step>
<step>
<cmd>Specify the context variable that contains the JWT to be validated.</cmd>
</step>
<step>
<cmd>Specify a context variable to store all the claims that the JWT contains.</cmd>
<info>After processing, the output data type is object.</info>
</step>
<step importance="optional">
<cmd>Specify the value to use to validate the issuer <q><codeph>iss</codeph></q> claim.</cmd>
</step>
<step importance="optional">
<cmd>Specify the value to use to validate the audience <q><codeph>aud</codeph></q> claim.</cmd>
</step>
<step>
<cmd>When the JWT is encrypted, specify the cryptographic material to decrypt the JWT.</cmd>
<info>You can specify a cryptographic object (a shared secret key or certificate) or a context
variable that contains the JWK to use to decrypt the JWT.</info>
</step>
<step>
<cmd>When the JWT is signed, specify the cryptographic material to verify the JWT.</cmd>
<info>You can specify a cryptographic object (a shared secret key or certificate) or a context
variable that contains the JWK to use to verify the JWT.</info>
</step>
<step conref="apigw_conref.dita#commonsteps/config_apply">
<cmd/>
</step>
<step conref="apigw_conref.dita#commonsteps/config_saveconfig">
<cmd/>
</step>
</steps>
</taskbody>
</task>
